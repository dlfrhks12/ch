<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cartMapper">
	
	<!-- 메뉴에서 카트 담을 떄 추가 부분 -->
	<insert id="insert">
		insert into cart (m_no, u_username, cart_name, cart_price, cart_day, 
		                  cart_count, image, cart_jumunMoney)
		values(#{mNo},#{uUsername}, #{cartName}, #{cartPrice}, sysdate, 
		       #{cartCount}, #{image}, #{cartJumunMoney})
	</insert>
	
	<!-- 카트목록리스트 -->
	<select id="findAllCart" resultType="cart">
		select m_no mNo, u_username uUsername, cart_name cartName, cart_price cartPrice, 
		       cart_day cartDay, cart_count cartCount, image, cart_jumunMoney cartJumunMoney
		from cart
	</select>
	
	<!-- 카트 수정 할 떄 필요한 번호 -->
	<select id="findByCartNo" resultType="cart">
		select m_no mNo, u_username uUsername, cart_name cartName, cart_price cartPrice, 
		       cart_day cartDay, cart_count cartCount, image, cart_jumunMoney cartJumunMoney
		from cart
		where m_no=#{m_no} and rownum=1
	</select>
	
	<!-- 장바구니 리스트 -->
	<select id="findCartList" resultType="cart">
		select m_no mNo, u_username uUsername, cart_name cartName, cart_price cartPrice, 
		       cart_day cartDay, cart_count cartCount, image, cart_jumunMoney cartJumunMoney
		from cart
		where u_username = #{uUsername}
	</select>
	
	<!-- 장바구니 업데이트 -->
	<update id="cartUpdate">
		update cart
		<trim suffixOverrides="," prefix="set">
			<if test="cartJumunMoney!=null">cart_count=#{cartCount},</if>
			<if test="cartJumunMoney!=null">cart_jumunMoney=#{cartJumunMoney}</if>
		</trim>
		where m_no=#{mNo} and rownum=1
	</update>
	
	<!-- 개수 증가 -->
   <update id="increaseByAmount">
      update cart set cart_count=#{cartCount}+1 where m_no=#{mNo}
   </update>
   
   <!-- 개수 감소 -->
   <update id="decreaseByAmount">
      update cart set cart_count=#{cartCount}-1 where m_no=#{mNo}
   </update>
	
	<!-- 카트삭제 -->
	<delete id="cartDelete">
		delete from cart 
		where m_No=#{mNo} and rownum=1
	</delete>
	
		<!-- 카트 수정 할 떄 필요한 번호 -->
	<select id="cartList" resultType="cart">
		select m_no mNo, u_username uUsername, cart_name cartName, cart_price cartPrice, 
		       cart_day cartDay, cart_count cartCount, image, cart_jumunMoney cartJumunMoney
		from cart
		where m_No=#{mNo} and rownum=1
	</select>
	
</mapper>












