<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="orderMapper">
<!-- orderInsert, order(목록), orderDelete, orderUpdate, orderAllSum --> 

	<!-- 예지   -->
	
	<!-- sNum으로 페이징 하려고 조건 만들어줌 -->
	<select id="countBysNum" resultType="int">
		select count(*) from orders where s_num=#{sNum}
	</select>
	
	  <!-- 해당매장 주문 리스트   -->
  	 <select id="orderListBySNum" resultType="order">
		select o_no oNo, o_total oTotal, o_order_time oOrderTime, u_username uUSername,
		o_check oCheck, s_num sNum from orders where s_num=#{sNum} 
  	 </select>  
	
	<!-- 주문리스트 출력시 주문제목보이기  -->
	<select id="ordercheck" resultType="detailorder">
		select d_sal dSal, d_menu_cnt dMenuCnt, d_menu_name dMenuName,
		o_no oNo, menuno, u_username uUsername from detailorder where o_no=#{oNo} and rownum=1
	</select>
	
	
	<!-- 해당 주문번호 내용 읽기  -->
	<select id="orderReadByONo" resultType="detailorder">
		select d_sal dSal, d_menu_cnt dMenuCnt, d_menu_name dMenuName,
		o_no oNo, menuno, u_username uUsername from detailorder where o_no=#{oNo} 
	</select>
	
	<!-- 주문읽을때 제목 만들기 -->
	<select id="countByOno" resultType="int">
		select count(*) from orders where o_no=#{oNo} 
	</select>


	<!-- 일관 -->
	<update id="insertOrderAll" parameterType="order">
		<foreach collection="list" item="item" open="INSERT ALL" separator=" " close="SELECT * FROM DUAL">
			into orders (order_no, menuno, u_username, cart_name, cart_price, cart_day, 
		                  cart_count, image, cart_jumunMoney) 
		    values(#{item.orderNo}, #{item.menuno},#{item.uUsername}, #{item.cartName}, #{item.cartPrice}, sysdate, 
		       	#{item.cartCount}, #{item.image}, #{item.cartJumunMoney})
		</foreach>
	</update>
	
<!-- 	<insert id="inserts">
		insert into cart(order_no, menuno, u_username, cart_name, cart_price, cart_day, 
		       cart_count, image, cart_jumunMoney)
		select * from orders where u_username=#{uUsername}
	</insert> -->
	
	<select id="findAlls" resultType="order">
		select order_no orderNo, menuno menuno, u_username uUsername, cart_name cartName, cart_price cartPrice, cart_day cartDay, 
		       cart_count cartCount, image, cart_jumunMoney cartJumunMoney
		from orders
	</select>

</mapper>












