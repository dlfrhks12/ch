<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="storeMapper">


<!-- 매장이 존재하는지 안하는지  -->
<select id="existsSnum" resultType="boolean">
	select count(*) from store where m_username=#{mUsername} and rownum=1
</select>


=======
<!-- musername 잠시 삭제함 -->
>>>>>>> branch 'master' of https://github.com/tjddnjs5092/CheatingDay.git
<select id="findBysNum" resultType="store">
select s_num sNum, s_sajin sSajin, s_info sInfo,
s_name sName, s_tel sTel, s_address sAddress, food_no foodNo, m_username mUsername from store where s_num=#{sNum} and rownum=1
</select>

<select id="findBymUsername" resultType="store">
select s_num sNum, s_sajin sSajin, s_info sInfo,
s_name sName, s_tel sTel, s_address sAddress, food_no foodNo, m_username mUsername from store where m_username=#{mUsername} and rownum=1
</select>

<!-- <select id="findAll" resultType="store">
select s_num sNum, s_sajin sSajin, s_info sInfo,
s_name sName, s_tel sTel, s_address sAddress, food_no foodNo, 
s_star_point sStarPoint, s_review_cnt sReviewCnt, m_username mUsername from store
</select> -->
	
<select id="findAllBymUsername" resultType="store">
select s_num sNum, s_sajin sSajin, s_info sInfo,
s_name sName, s_tel sTel, s_address sAddress, food_no foodNo, 
s_star_point sStarPoint, s_review_cnt sReviewCnt, m_username mUsername from store where m_username=#{mUsername} 
</select>

<insert id="insert">
<selectKey order="BEFORE" resultType="int" keyProperty="sNum">
select store_seq.nextval from dual
</selectKey>

insert into store(s_num,s_sajin,s_info,s_name,s_tel,s_address,
food_no,s_star_point,s_review_cnt,m_username) values(#{sNum},#{sSajin},#{sInfo},#{sName},
#{sTel},#{sAddress},#{foodNo},0,0,#{mUsername})
</insert>

<update id="update">
update store
	<trim prefix="set" suffixOverrides=",">
		<if test="sSajin!=null">s_sajin=#{sSajin},</if>
		<if test="sInfo!=null">s_info=#{sInfo},</if>
		<if test="sName!=null">s_name=#{sName},</if>
		<if test="sTel!=null">s_tel=#{sTel},</if>
		<if test="sAddress!=null">s_address=#{sAddress},</if>
	</trim>
	where s_num=#{sNum} and rownum=1
</update>	

<delete id="delete">
	delete from store where s_num=#{sNum} and rownum=1
</delete>
</mapper>












